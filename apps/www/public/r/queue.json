{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "queue",
  "type": "registry:component",
  "dependencies": ["zustand", "lucide-react"],
  "registryDependencies": [
    "@audio/store",
    "@audio/lib",
    "@audio/track",
    "@audio/provider",
    "@shadcn/empty",
    "@shadcn/button",
    "@shadcn/command",
    "@shadcn/dialog",
    "@shadcn/dropdown-menu",
    "@shadcn/input",
    "@shadcn/item",
    "@shadcn/scroll-area",
    "@shadcn/toggle",
    "@shadcn/tooltip"
  ],
  "files": [
    {
      "path": "src/registry/default/ui/audio/queue.tsx",
      "content": "\"use client\";\n\nimport {\n  ListMusicIcon,\n  Repeat1Icon,\n  RepeatIcon,\n  ShuffleIcon,\n  SlidersHorizontalIcon,\n  TrashIcon,\n} from \"lucide-react\";\nimport type { ComponentProps } from \"react\";\nimport React from \"react\";\nimport type { Track } from \"@/registry/default/lib/audio\";\nimport {\n  type InsertMode,\n  type RepeatMode,\n  useAudioStore,\n} from \"@/registry/default/lib/audio-store\";\nimport { cn } from \"@/registry/default/lib/utils\";\nimport { AudioTrackList } from \"@/registry/default/ui/audio/track\";\nimport { Button } from \"@/registry/default/ui/button\";\nimport {\n  Command,\n  CommandInput,\n  CommandList,\n} from \"@/registry/default/ui/command\";\nimport {\n  Dialog,\n  DialogContent,\n  DialogDescription,\n  DialogHeader,\n  DialogTitle,\n  DialogTrigger,\n} from \"@/registry/default/ui/dialog\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuLabel,\n  DropdownMenuRadioGroup,\n  DropdownMenuRadioItem,\n  DropdownMenuTrigger,\n} from \"@/registry/default/ui/dropdown-menu\";\nimport { Toggle } from \"@/registry/default/ui/toggle\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/registry/default/ui/tooltip\";\n\n/**\n * Props for the AudioQueueButton component.\n */\nexport interface AudioQueueButtonProps extends ComponentProps<typeof Button> {\n  tooltip?: boolean;\n  tooltipLabel?: string;\n}\n\nfunction AudioQueueButton({\n  tooltip = false,\n  tooltipLabel,\n  ...props\n}: AudioQueueButtonProps) {\n  if (tooltip && tooltipLabel) {\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>\n          <Button {...props} />\n        </TooltipTrigger>\n        <TooltipContent sideOffset={4}>{tooltipLabel}</TooltipContent>\n      </Tooltip>\n    );\n  }\n\n  return <Button {...props} />;\n}\n\nconst AudioQueueRepeatMode = ({\n  className,\n  ...props\n}: ComponentProps<typeof Toggle>) => {\n  const repeatMode = useAudioStore((state) => state.repeatMode);\n  const changeRepeatMode = useAudioStore((state) => state.changeRepeatMode);\n  const handleRepeat = React.useCallback(() => {\n    changeRepeatMode();\n  }, [changeRepeatMode]);\n\n  const Icon = repeatMode === \"one\" ? Repeat1Icon : RepeatIcon;\n  let repeatTooltip = \"Disable repeat\";\n  if (repeatMode === \"one\") {\n    repeatTooltip = \"Repeat this track\";\n  } else if (repeatMode === \"all\") {\n    repeatTooltip = \"Repeat playlist\";\n  }\n\n  const isPressed = repeatMode !== \"none\";\n\n  const toggle = (\n    <Toggle\n      className={cn(\n        className,\n        isPressed && \"bg-accent! text-accent-foreground!\"\n      )}\n      data-slot=\"audio-queue-repeat-mode\"\n      onPressedChange={handleRepeat}\n      pressed={isPressed}\n      {...props}\n    >\n      <Icon className=\"size-4\" />\n    </Toggle>\n  );\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{toggle}</TooltipTrigger>\n      <TooltipContent side=\"top\" sideOffset={4}>\n        {repeatTooltip}\n      </TooltipContent>\n    </Tooltip>\n  );\n};\n\nconst AudioQueueShuffle = ({\n  className,\n  ...props\n}: Omit<ComponentProps<typeof Toggle>, \"onPressedChange\">) => {\n  const shuffle = useAudioStore((state) => state.shuffle);\n  const unshuffle = useAudioStore((state) => state.unshuffle);\n  const shuffleEnabled = useAudioStore((state) => state.shuffleEnabled);\n\n  const handleShuffle = React.useCallback(\n    (pressed: boolean) => {\n      if (pressed) {\n        shuffle();\n      } else {\n        unshuffle();\n      }\n    },\n    [shuffle, unshuffle]\n  );\n\n  const toggle = (\n    <Toggle\n      aria-label=\"Shuffle\"\n      className={cn(\n        className,\n        shuffleEnabled && \"bg-accent! text-accent-foreground!\"\n      )}\n      data-slot=\"audio-queue-shuffle\"\n      onPressedChange={handleShuffle}\n      pressed={shuffleEnabled}\n      {...props}\n    >\n      <ShuffleIcon className=\"size-4\" />\n    </Toggle>\n  );\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{toggle}</TooltipTrigger>\n      <TooltipContent side=\"top\" sideOffset={4}>\n        Shuffle {shuffleEnabled ? \"on\" : \"off\"}\n      </TooltipContent>\n    </Tooltip>\n  );\n};\n\nconst AudioQueuePreferences = ({\n  className,\n  variant = \"outline\",\n  size = \"icon\",\n  tooltip = true,\n  tooltipLabel = \"Queue preferences\",\n  ...props\n}: React.ComponentProps<typeof AudioQueueButton>) => {\n  const repeatMode = useAudioStore((state) => state.repeatMode);\n  const setRepeatMode = useAudioStore((state) => state.setRepeatMode);\n  const insertMode = useAudioStore((state) => state.insertMode);\n  const setInsertMode = useAudioStore((state) => state.setInsertMode);\n\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <AudioQueueButton\n          className={cn(className)}\n          data-slot=\"audio-queue-preferences-trigger\"\n          size={size}\n          tooltip\n          tooltipLabel={tooltipLabel}\n          variant={variant}\n          {...props}\n        >\n          <SlidersHorizontalIcon className=\"size-4\" />\n        </AudioQueueButton>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent\n        align=\"end\"\n        className={cn(\"w-45\", className)}\n        data-slot=\"audio-queue-preferences-content\"\n      >\n        <DropdownMenuLabel className=\"text-muted-foreground\">\n          Repeat Mode\n        </DropdownMenuLabel>\n        <DropdownMenuRadioGroup\n          onValueChange={(value) => setRepeatMode(value as RepeatMode)}\n          value={repeatMode}\n        >\n          <DropdownMenuRadioItem value=\"none\">None</DropdownMenuRadioItem>\n          <DropdownMenuRadioItem value=\"one\">One</DropdownMenuRadioItem>\n          <DropdownMenuRadioItem value=\"all\">All</DropdownMenuRadioItem>\n        </DropdownMenuRadioGroup>\n\n        <DropdownMenuLabel className=\"text-muted-foreground\">\n          Insert Mode\n        </DropdownMenuLabel>\n\n        <DropdownMenuRadioGroup\n          onValueChange={(value) => setInsertMode(value as InsertMode)}\n          value={insertMode}\n        >\n          <DropdownMenuRadioItem value=\"first\">First</DropdownMenuRadioItem>\n          <DropdownMenuRadioItem value=\"last\">Last</DropdownMenuRadioItem>\n          <DropdownMenuRadioItem value=\"after\">\n            After Current\n          </DropdownMenuRadioItem>\n        </DropdownMenuRadioGroup>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n};\n\n/**\n * Props for the AudioQueue component.\n */\nexport type AudioQueueProps = {\n  onTrackSelect?: (index: number) => void;\n  searchPlaceholder?: string;\n  emptyLabel?: string;\n  emptyDescription?: string;\n};\n\nconst AudioQueue = React.memo(\n  ({\n    onTrackSelect,\n    searchPlaceholder = \"Search for a track...\",\n    emptyLabel = \"No tracks found\",\n    emptyDescription = \"Try searching for a different track\",\n  }: AudioQueueProps) => {\n    const togglePlay = useAudioStore((state) => state.togglePlay);\n    const currentTrackId = useAudioStore((state) => state.currentTrack?.id);\n    const setQueueAndPlay = useAudioStore((state) => state.setQueueAndPlay);\n    const clearQueue = useAudioStore((state) => state.clearQueue);\n    const removeFromQueue = useAudioStore((state) => state.removeFromQueue);\n\n    const [dialogOpen, setDialogOpen] = React.useState(false);\n    const [searchQuery, setSearchQuery] = React.useState(\"\");\n\n    const isFiltered = searchQuery.trim().length > 0;\n\n    const handleTrackSelect = React.useCallback(\n      (index: number) => {\n        const currentQueue = useAudioStore.getState().queue;\n        let filtered = currentQueue;\n\n        if (searchQuery.trim()) {\n          const query = searchQuery.toLowerCase();\n          filtered = currentQueue.filter(\n            (t: Track) =>\n              t.title?.toLowerCase().includes(query) ||\n              t.artist?.toLowerCase().includes(query)\n          );\n        }\n\n        const selectedTrack = filtered[index];\n        if (!selectedTrack) {\n          return;\n        }\n\n        const trackIndex = currentQueue.findIndex(\n          (t) => t.id === selectedTrack.id\n        );\n        if (trackIndex < 0) {\n          return;\n        }\n\n        if (currentTrackId === selectedTrack.id) {\n          togglePlay();\n        } else if (currentQueue.length > 0) {\n          setQueueAndPlay(currentQueue, trackIndex);\n        }\n        onTrackSelect?.(trackIndex);\n        setDialogOpen(false);\n      },\n      [searchQuery, currentTrackId, togglePlay, setQueueAndPlay, onTrackSelect]\n    );\n\n    const handleTrackRemove = React.useCallback(\n      (trackId: string) => {\n        removeFromQueue(trackId);\n      },\n      [removeFromQueue]\n    );\n\n    const handleClearQueue = React.useCallback(() => {\n      clearQueue();\n    }, [clearQueue]);\n\n    return (\n      <Dialog\n        onOpenChange={(isOpen) => {\n          setDialogOpen(isOpen);\n          if (!isOpen) {\n            setSearchQuery(\"\");\n          }\n        }}\n        open={dialogOpen}\n      >\n        <DialogTrigger asChild>\n          <AudioQueueButton\n            size=\"icon\"\n            tooltip\n            tooltipLabel=\"Queue\"\n            variant=\"outline\"\n          >\n            <ListMusicIcon />\n          </AudioQueueButton>\n        </DialogTrigger>\n        <DialogContent\n          aria-label=\"Select a track\"\n          className=\"rounded-xl border-none bg-clip-padding p-2 pb-11 shadow-2xl ring-4 ring-neutral-200/80 dark:bg-neutral-900 dark:ring-neutral-800\"\n          data-slot=\"audio-queue\"\n          showCloseButton={false}\n        >\n          <DialogHeader className=\"sr-only\">\n            <DialogTitle>Audio Queue</DialogTitle>\n            <DialogDescription>\n              Select a track from the queue to play\n            </DialogDescription>\n          </DialogHeader>\n          <Command\n            className=\"rounded-none bg-transparent **:data-[slot=command-input-wrapper]:mb-0 **:data-[slot=command-input-wrapper]:h-9! **:data-[slot=command-input]:h-9! **:data-[slot=command-input-wrapper]:rounded-md **:data-[slot=command-input-wrapper]:border **:data-[slot=command-input-wrapper]:border-input **:data-[slot=command-input-wrapper]:bg-input/50 **:data-[slot=command-input]:py-0\"\n            filter={(value, search, keywords) => {\n              const extendValue = `${value} ${keywords?.join(\" \") || \"\"}`;\n              if (extendValue.toLowerCase().includes(search.toLowerCase())) {\n                return 1;\n              }\n              return 0;\n            }}\n          >\n            <CommandInput\n              onValueChange={setSearchQuery}\n              placeholder={searchPlaceholder}\n              value={searchQuery}\n            />\n            <CommandList className=\"pt-2 pb-1\">\n              <AudioTrackList\n                className=\"mx-0\"\n                emptyDescription={emptyDescription}\n                emptyLabel={emptyLabel}\n                filterQuery={searchQuery}\n                onTrackRemove={handleTrackRemove}\n                onTrackSelect={handleTrackSelect}\n                sortable={!isFiltered}\n              />\n            </CommandList>\n          </Command>\n          <div className=\"absolute inset-x-0 bottom-0 z-20 flex items-center gap-2 rounded-b-xl border-t border-t-neutral-100 bg-neutral-50 p-1 font-medium text-muted-foreground text-xs dark:border-t-neutral-700 dark:bg-neutral-800\">\n            <AudioQueueButton\n              className=\"w-full\"\n              onClick={handleClearQueue}\n              size=\"sm\"\n              title=\"Clear queue\"\n              variant=\"destructive\"\n            >\n              <TrashIcon className=\"size-4\" /> Clear\n            </AudioQueueButton>\n          </div>\n        </DialogContent>\n      </Dialog>\n    );\n  }\n);\nexport {\n  AudioQueue,\n  AudioQueueButton,\n  AudioQueuePreferences,\n  AudioQueueRepeatMode,\n  AudioQueueShuffle,\n};\n",
      "type": "registry:component",
      "target": "components/audio/queue.tsx"
    }
  ]
}

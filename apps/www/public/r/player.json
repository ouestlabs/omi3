{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "player",
  "type": "registry:component",
  "dependencies": ["zustand", "lucide-react"],
  "registryDependencies": [
    "@audio/store",
    "@audio/lib",
    "@audio/provider",
    "@audio/slider",
    "@shadcn/empty",
    "@shadcn/button",
    "@shadcn/dialog",
    "@shadcn/dropdown-menu",
    "@shadcn/input",
    "@shadcn/item",
    "@shadcn/scroll-area",
    "@shadcn/toggle",
    "@shadcn/tooltip"
  ],
  "files": [
    {
      "path": "src/registry/default/ui/audio/player.tsx",
      "content": "\"use client\";\n\nimport { cva, type VariantProps } from \"class-variance-authority\";\nimport {\n  FastForwardIcon,\n  Loader2Icon,\n  PauseIcon,\n  PlayIcon,\n  RadioIcon,\n  RewindIcon,\n  SkipBackIcon,\n  SkipForwardIcon,\n  Volume1Icon,\n  Volume2Icon,\n  VolumeIcon,\n  VolumeXIcon,\n} from \"lucide-react\";\nimport React from \"react\";\nimport { formatDuration, isLive } from \"@/registry/default/lib/audio\";\nimport { useAudioStore } from \"@/registry/default/lib/audio-store\";\nimport { cn } from \"@/registry/default/lib/utils\";\nimport { Button, type buttonVariants } from \"@/registry/default/ui/button\";\nimport {\n  DropdownMenu,\n  DropdownMenuContent,\n  DropdownMenuTrigger,\n} from \"@/registry/default/ui/dropdown-menu\";\nimport { Slider } from \"@/registry/default/ui/slider\";\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n} from \"@/registry/default/ui/tooltip\";\n\ninterface AudioPlayerButtonProps extends React.ComponentProps<typeof Button> {\n  tooltip?: boolean;\n  tooltipLabel?: string;\n}\n\nfunction AudioPlayerButton({\n  tooltip = false,\n  tooltipLabel,\n  ...props\n}: AudioPlayerButtonProps) {\n  const button = <Button {...props} />;\n\n  if (tooltip && tooltipLabel) {\n    return (\n      <Tooltip>\n        <TooltipTrigger asChild>{button}</TooltipTrigger>\n        <TooltipContent sideOffset={4}>{tooltipLabel}</TooltipContent>\n      </Tooltip>\n    );\n  }\n\n  return button;\n}\n\nfunction AudioPlayer({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      className={cn(\n        \"w-full rounded-(--radius) border bg-card p-1.5\",\n        className\n      )}\n      data-slot=\"audio-player\"\n      role=\"presentation\"\n      {...props}\n    >\n      {children}\n    </div>\n  );\n}\n\nconst audioControlBarVariants = cva(\n  \"group/audio-control-bar flex w-full min-w-0 items-center gap-1.5\",\n  {\n    variants: {\n      variant: {\n        compact: \"flex-row\",\n        stacked: \"flex-col\",\n      },\n    },\n    defaultVariants: {\n      variant: \"compact\",\n    },\n  }\n);\n\n/**\n * Props for the AudioPlayerControlBar component.\n */\nexport type AudioPlayerControlBarProps = React.ComponentProps<\"div\"> &\n  VariantProps<typeof audioControlBarVariants>;\n\nconst AudioPlayerControlBar = ({\n  className,\n  variant,\n  ...props\n}: AudioPlayerControlBarProps) => (\n  <div\n    className={cn(audioControlBarVariants({ variant }), className)}\n    data-slot=\"audio-control-bar\"\n    data-variant={variant}\n    {...props}\n  />\n);\n\n/**\n * Props for the AudioPlayerControlGroup component.\n */\nexport type AudioPlayerControlGroupProps = React.ComponentProps<\"div\">;\n\nconst AudioPlayerControlGroup = ({\n  className,\n  ...props\n}: AudioPlayerControlGroupProps) => (\n  <div\n    className={cn(\"flex w-full items-center gap-1.5\", className)}\n    data-slot=\"audio-control-group\"\n    {...props}\n  />\n);\n\n/**\n * Props for the AudioPlayerTimeDisplay component.\n */\nexport type AudioPlayerTimeDisplayProps = React.ComponentProps<\"time\"> & {\n  remaining?: boolean;\n};\n\nconst AudioPlayerTimeDisplay = ({\n  className,\n  remaining,\n  ...props\n}: AudioPlayerTimeDisplayProps) => {\n  const { currentTime, duration, currentTrack } = useAudioStore();\n  const isLiveStream = currentTrack ? isLive(currentTrack) : false;\n\n  const formattedCurrentTime = React.useMemo(\n    () => formatDuration(currentTime),\n    [currentTime]\n  );\n\n  const formattedRemainingTime = React.useMemo(\n    () => formatDuration(duration - currentTime),\n    [duration, currentTime]\n  );\n\n  const timeValue = React.useMemo(() => {\n    if (isLiveStream && remaining) {\n      return \"LIVE\";\n    }\n\n    if (isLiveStream && !remaining) {\n      return formattedCurrentTime;\n    }\n\n    return remaining ? formattedRemainingTime : formattedCurrentTime;\n  }, [isLiveStream, remaining, formattedCurrentTime, formattedRemainingTime]);\n\n  const showLiveIcon = isLiveStream && remaining;\n\n  return (\n    <time\n      className={cn(\n        \"min-w-12 shrink-0 px-1.5 text-left font-mono text-sm tabular-nums\",\n        remaining && \"text-right\",\n        showLiveIcon && \"flex items-center gap-1 text-red-500 text-xs\",\n        className\n      )}\n      data-live={isLiveStream ? \"true\" : undefined}\n      data-remaining={remaining ? \"true\" : undefined}\n      data-slot=\"audio-time-display\"\n      {...props}\n    >\n      {showLiveIcon && <RadioIcon className=\"size-3 animate-pulse\" />}\n      {timeValue}\n    </time>\n  );\n};\n\nconst AudioPlayerSeekBar = ({\n  className,\n  ...props\n}: Omit<\n  React.ComponentProps<typeof Slider>,\n  \"value\" | \"onValueChange\" | \"min\" | \"max\" | \"bufferValue\"\n>) => {\n  const { currentTime, duration, seek, bufferedTime, currentTrack } =\n    useAudioStore();\n  const isLiveStream = currentTrack ? isLive(currentTrack) : false;\n\n  const progress = React.useMemo(() => {\n    if (isLiveStream) {\n      return 100;\n    }\n    if (!duration) {\n      return 0;\n    }\n    return (currentTime / duration) * 100;\n  }, [isLiveStream, currentTime, duration]);\n\n  const bufferedProgress = React.useMemo(() => {\n    if (isLiveStream) {\n      return 100;\n    }\n    if (!duration) {\n      return 0;\n    }\n    return (bufferedTime / duration) * 100;\n  }, [isLiveStream, bufferedTime, duration]);\n\n  const handleSeek = (e: React.MouseEvent | React.TouchEvent) => {\n    if (isLiveStream || !duration) {\n      return;\n    }\n\n    const target = e.currentTarget;\n    let clientX: number;\n\n    if (\"touches\" in e) {\n      clientX = e.touches[0]?.clientX ?? 0;\n    } else {\n      clientX = e.clientX;\n    }\n\n    const rect = target.getBoundingClientRect();\n    const position = Math.max(\n      0,\n      Math.min(1, (clientX - rect.left) / rect.width)\n    );\n    seek(position * duration);\n  };\n\n  const handleTouchStart = (e: React.TouchEvent) => {\n    if (!isLiveStream) {\n      handleSeek(e);\n    }\n  };\n\n  const handleTouchMove = (e: React.TouchEvent) => {\n    if (!isLiveStream) {\n      e.preventDefault();\n      handleSeek(e);\n    }\n  };\n\n  const handleMouseMove = (e: React.MouseEvent) => {\n    if (!isLiveStream && e.buttons === 1) {\n      handleSeek(e);\n    }\n  };\n\n  return (\n    <Slider\n      bufferValue={bufferedProgress}\n      className={cn(\"min-w-20 flex-1\", className)}\n      disabled={isLiveStream}\n      max={100}\n      min={0}\n      onMouseMove={handleMouseMove}\n      onTouchMove={handleTouchMove}\n      onTouchStart={handleTouchStart}\n      onValueChange={(value) => {\n        if (!isLiveStream && value?.[0] !== undefined && duration > 0) {\n          const newTime = (value[0] / 100) * duration;\n          seek(newTime);\n        }\n      }}\n      value={[progress]}\n      {...props}\n    />\n  );\n};\n\nconst AudioPlayerVolume = ({\n  className,\n  size = \"icon\",\n  variant = \"outline\",\n  ...props\n}: Omit<\n  React.ComponentProps<typeof Slider>,\n  \"value\" | \"onValueChange\" | \"min\" | \"max\"\n> & {\n  size?: VariantProps<typeof buttonVariants>[\"size\"];\n  variant?: VariantProps<typeof buttonVariants>[\"variant\"];\n}) => {\n  const volume = useAudioStore((state) => state.volume);\n  const isMuted = useAudioStore((state) => state.isMuted);\n  const setVolume = useAudioStore((state) => state.setVolume);\n  const toggleMute = useAudioStore((state) => state.toggleMute);\n\n  const volumePercent = Math.round(volume * 100);\n\n  const getVolumeIcon = () => {\n    if (isMuted || volume === 0) {\n      return VolumeXIcon;\n    }\n    if (volumePercent < 33) {\n      return VolumeIcon;\n    }\n    if (volumePercent < 66) {\n      return Volume1Icon;\n    }\n    return Volume2Icon;\n  };\n\n  const Icon = getVolumeIcon();\n  return (\n    <DropdownMenu>\n      <DropdownMenuTrigger asChild>\n        <AudioPlayerButton\n          className={cn(\"hidden md:flex\", className)}\n          data-slot=\"audio-volume-button\"\n          size={size}\n          tooltip\n          tooltipLabel={\n            isMuted ? \"Muted\" : `Volume ${Math.round(volumePercent)}%`\n          }\n          variant={variant}\n        >\n          <Icon className={cn(isMuted && \"opacity-40\", \"text-primary\")} />\n        </AudioPlayerButton>\n      </DropdownMenuTrigger>\n      <DropdownMenuContent\n        className={cn(\"flex w-48 flex-col gap-1.5 p-1.5\", className)}\n      >\n        <div className=\"flex items-center justify-between\">\n          <span className=\"text-sm\">Volume</span>\n          <span className=\"font-mono text-sm tabular-nums\">\n            {volumePercent}%\n          </span>\n        </div>\n        <div className=\"flex items-center gap-2\">\n          <VolumeXIcon\n            aria-hidden=\"true\"\n            className={cn(\n              \"size-4 shrink-0 cursor-pointer\",\n              isMuted ? \"opacity-40\" : \"opacity-60\"\n            )}\n            onClick={toggleMute}\n            role=\"button\"\n          />\n          <Slider\n            className={cn(className)}\n            max={100}\n            min={0}\n            onValueChange={(value) => {\n              if (value?.[0] !== undefined) {\n                setVolume({ volume: value[0] / 100 });\n                if (value[0] === 0) {\n                  toggleMute();\n                } else if (isMuted) {\n                  toggleMute();\n                }\n              }\n            }}\n            value={[volumePercent]}\n            {...props}\n          />\n          <Volume2Icon\n            aria-hidden=\"true\"\n            className=\"size-4 shrink-0 opacity-60\"\n          />\n        </div>\n      </DropdownMenuContent>\n    </DropdownMenu>\n  );\n};\n\nconst AudioPlayerPlay = React.memo(\n  ({\n    className,\n    onClick,\n    size = \"icon\",\n    variant = \"ghost\",\n    ...props\n  }: React.ComponentProps<typeof AudioPlayerButton>) => {\n    const isPlaying = useAudioStore((state) => state.isPlaying);\n    const isLoading = useAudioStore((state) => state.isLoading);\n    const isBuffering = useAudioStore((state) => state.isBuffering);\n    const currentTrack = useAudioStore((state) => state.currentTrack);\n\n    const togglePlay = useAudioStore((state) => state.togglePlay);\n\n    const handleKeyPress = React.useCallback(\n      (event: KeyboardEvent) => {\n        if (event.code === \"Space\" && event.target === document.body) {\n          event.preventDefault();\n          togglePlay();\n        }\n      },\n      [togglePlay]\n    );\n\n    React.useEffect(() => {\n      document.addEventListener(\"keydown\", handleKeyPress);\n      return () => document.removeEventListener(\"keydown\", handleKeyPress);\n    }, [handleKeyPress]);\n\n    const showSpinner = isLoading || isBuffering;\n\n    const handleClick = React.useCallback(\n      (e: React.MouseEvent<HTMLButtonElement>) => {\n        onClick?.(e);\n        togglePlay();\n      },\n      [onClick, togglePlay]\n    );\n\n    return (\n      <AudioPlayerButton\n        aria-label={isPlaying ? \"Pause\" : \"Play\"}\n        className={cn(className)}\n        data-slot=\"audio-play-button\"\n        disabled={showSpinner || !currentTrack}\n        onClick={handleClick}\n        size={size}\n        tooltip\n        tooltipLabel={isPlaying ? \"Pause\" : \"Play\"}\n        variant={variant}\n        {...props}\n      >\n        {showSpinner && <Loader2Icon className=\"animate-spin\" />}\n        {!showSpinner && isPlaying && <PauseIcon fill=\"currentColor\" />}\n        {!(showSpinner || isPlaying) && <PlayIcon fill=\"currentColor\" />}\n      </AudioPlayerButton>\n    );\n  }\n);\n\nconst AudioPlayerRewind = React.memo(\n  ({\n    className,\n    onClick,\n    size = \"icon\",\n    variant = \"ghost\",\n    ...props\n  }: React.ComponentProps<typeof AudioPlayerButton>) => {\n    const currentTime = useAudioStore((state) => state.currentTime);\n    const seek = useAudioStore((state) => state.seek);\n    const currentTrack = useAudioStore((state) => state.currentTrack);\n    const isLiveStream = currentTrack ? isLive(currentTrack) : false;\n\n    const seekBackward = React.useCallback(\n      (seconds = 10) => {\n        const newTime = Math.max(currentTime - seconds, 0);\n        seek(newTime);\n      },\n      [currentTime, seek]\n    );\n\n    const disableSeekBackward = React.useMemo(\n      () => !currentTrack || currentTime <= 0 || isLiveStream,\n      [currentTrack, currentTime, isLiveStream]\n    );\n\n    return (\n      <AudioPlayerButton\n        className={cn(className)}\n        data-slot=\"audio-rewind-button\"\n        disabled={disableSeekBackward}\n        onClick={(e) => {\n          onClick?.(e);\n          if (!isLiveStream) {\n            seekBackward(10);\n          }\n        }}\n        size={size}\n        tooltip\n        tooltipLabel={\n          isLiveStream ? \"Not available for live streams\" : \"Skip backward\"\n        }\n        variant={variant}\n        {...props}\n      >\n        <RewindIcon fill=\"currentColor\" />\n      </AudioPlayerButton>\n    );\n  }\n);\n\nconst AudioPlayerFastForward = React.memo(\n  ({\n    className,\n    onClick,\n    size = \"icon\",\n    variant = \"ghost\",\n    ...props\n  }: React.ComponentProps<typeof AudioPlayerButton>) => {\n    const currentTime = useAudioStore((state) => state.currentTime);\n    const seek = useAudioStore((state) => state.seek);\n    const duration = useAudioStore((state) => state.duration);\n    const currentTrack = useAudioStore((state) => state.currentTrack);\n    const isLiveStream = currentTrack ? isLive(currentTrack) : false;\n\n    const seekForward = React.useCallback(\n      (seconds = 10) => {\n        const newTime = Math.min(currentTime + seconds, duration);\n        seek(newTime);\n      },\n      [duration, seek, currentTime]\n    );\n\n    const disableSeekForward = React.useMemo(() => {\n      if (!currentTrack || isLiveStream) {\n        return true;\n      }\n      return duration > 0 && currentTime >= duration;\n    }, [currentTrack, currentTime, duration, isLiveStream]);\n\n    return (\n      <AudioPlayerButton\n        className={cn(className)}\n        data-slot=\"audio-fast-forward-button\"\n        disabled={disableSeekForward}\n        onClick={(e) => {\n          onClick?.(e);\n          if (!isLiveStream) {\n            seekForward(10);\n          }\n        }}\n        size={size}\n        tooltip\n        tooltipLabel={\n          isLiveStream ? \"Not available for live streams\" : \"Skip forward\"\n        }\n        variant={variant}\n        {...props}\n      >\n        <FastForwardIcon fill=\"currentColor\" />\n      </AudioPlayerButton>\n    );\n  }\n);\n\nconst AudioPlayerSkipForward = React.memo(\n  ({\n    className,\n    onClick,\n    size = \"icon\",\n    variant = \"ghost\",\n    ...props\n  }: React.ComponentProps<typeof AudioPlayerButton>) => {\n    const repeatMode = useAudioStore((state) => state.repeatMode);\n    const queueLength = useAudioStore((state) => state.queue.length);\n    const currentQueueIndex = useAudioStore((state) => state.currentQueueIndex);\n    const currentTrack = useAudioStore((state) => state.currentTrack);\n\n    const next = useAudioStore((state) => state.next);\n\n    const disableNext = React.useMemo(\n      () =>\n        !currentTrack ||\n        (currentQueueIndex === queueLength - 1 && repeatMode !== \"all\"),\n      [currentTrack, currentQueueIndex, queueLength, repeatMode]\n    );\n\n    return (\n      <AudioPlayerButton\n        aria-label=\"Next\"\n        className={cn(className)}\n        data-slot=\"audio-skip-forward-button\"\n        disabled={disableNext}\n        onClick={next}\n        size={size}\n        tooltip\n        tooltipLabel=\"Next\"\n        variant={variant}\n        {...props}\n      >\n        <SkipForwardIcon fill=\"currentColor\" />\n      </AudioPlayerButton>\n    );\n  }\n);\n\nconst AudioPlayerSkipBack = React.memo(\n  ({\n    className,\n    onClick,\n    size = \"icon\",\n    variant = \"ghost\",\n    ...props\n  }: React.ComponentProps<typeof AudioPlayerButton>) => {\n    const repeatMode = useAudioStore((state) => state.repeatMode);\n    const currentQueueIndex = useAudioStore((state) => state.currentQueueIndex);\n    const currentTrack = useAudioStore((state) => state.currentTrack);\n\n    const previous = useAudioStore((state) => state.previous);\n\n    const disablePrevious = React.useMemo(\n      () => !currentTrack || (currentQueueIndex === 0 && repeatMode !== \"all\"),\n      [currentTrack, currentQueueIndex, repeatMode]\n    );\n\n    return (\n      <AudioPlayerButton\n        className={cn(className)}\n        data-slot=\"audio-skip-back-button\"\n        disabled={disablePrevious}\n        onClick={previous}\n        size={size}\n        tooltip\n        tooltipLabel=\"Previous\"\n        variant={variant}\n        {...props}\n      >\n        <SkipBackIcon fill=\"currentColor\" />\n      </AudioPlayerButton>\n    );\n  }\n);\n\nexport {\n  AudioPlayerButton,\n  AudioPlayerControlBar,\n  AudioPlayerControlGroup,\n  AudioPlayerFastForward,\n  AudioPlayerPlay,\n  AudioPlayerRewind,\n  AudioPlayerSeekBar,\n  AudioPlayerSkipBack,\n  AudioPlayerSkipForward,\n  AudioPlayerTimeDisplay,\n  AudioPlayerVolume,\n  AudioPlayer,\n};\n",
      "type": "registry:component",
      "target": "components/audio/player.tsx"
    }
  ]
}
